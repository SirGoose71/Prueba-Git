name: Setup Linux GUI with Java

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  setup-gui:
    runs-on: ubuntu-latest

    steps:
      - name: Actualizar paquetes
        run: |
          sudo apt update && sudo apt upgrade -y

      - name: Instalar entorno gr√°fico Xfce y VNC
        run: |
          sudo apt install -y xfce4 xfce4-goodies tightvncserver
          mkdir -p ~/.vnc
          echo "xfce4-session &" > ~/.vnc/xstartup
          chmod +x ~/.vnc/xstartup
          vncserver :1 -geometry 1280x720 -depth 24

      - name: Instalar Java (OpenJDK 17)
        run: |
          sudo apt install -y openjdk-17-jdk
          java -version

      - name: Obtener la direcci√≥n IP p√∫blica y usuario
        run: |
          IP_PUBLICA=$(curl -s ifconfig.me)
          USUARIO=$(whoami)
          echo "Direcci√≥n IP P√∫blica: $IP_PUBLICA"
          echo "Usuario en la m√°quina: $USUARIO"

      - name: Mostrar instrucciones de conexi√≥n
        run: |
          IP_PUBLICA=$(curl -s ifconfig.me)
          USUARIO=$(whoami)
          echo "==============================================="
          echo "üîó C√≥mo conectarte a esta m√°quina desde tu Mac"
          echo "==============================================="
          echo "1Ô∏è‚É£ Abre una terminal en tu Mac"
          echo "2Ô∏è‚É£ Establece un t√∫nel SSH con este comando:"
          echo "   ssh -L 5901:localhost:5901 $USUARIO@$IP_PUBLICA"
          echo "3Ô∏è‚É£ Luego, abre el cliente VNC con este comando:"
          echo "   open vnc://localhost:5901"
          echo "==============================================="
          echo "üî• Ahora puedes acceder a la interfaz gr√°fica remotamente."
